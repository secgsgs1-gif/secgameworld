<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>로그인 | Web Game Pack</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body{margin:0;min-height:100vh;display:grid;place-items:center;background:linear-gradient(150deg,#081626,#1f3347);font-family:"Space Grotesk",sans-serif;color:#f3fbff}
    .box{width:min(92vw,420px);padding:20px;border-radius:14px;border:1px solid #9fcaff66;background:#0f2134d9}
    h1{margin:0 0 8px}.tabs{display:flex;gap:6px;margin:10px 0}
    .tabs button,input,button[type='submit']{padding:10px 12px;border-radius:8px;border:1px solid #9fcaff66;background:#17304b;color:#f3fbff}
    form{display:grid;gap:8px} .msg{min-height:1.3em;font-size:.92rem;color:#c9e8ff}
  </style>
</head>
<body>
  <main class="box">
    <h1>WEB GAME PACK</h1>
    <p>회원가입/로그인 후 입장 가능합니다.</p>

    <div class="tabs">
      <button id="tab-login" type="button">로그인</button>
      <button id="tab-signup" type="button">회원가입</button>
    </div>

    <form id="auth-form">
      <input id="username" type="text" placeholder="아이디(영문/숫자/_)" required />
      <input id="password" type="password" placeholder="비밀번호(6자 이상)" required />
      <button id="submit" type="submit">로그인</button>
      <p class="msg" id="msg"></p>
    </form>
  </main>

  <script>window.APP_ROOT = "../";</script>
  <script type="module" src="../shared/auth-guard.js?v=20260224m"></script>
  <script type="module">
    import { signInWithUsername, signUpWithUsername } from "../shared/auth.js?v=20260224m";

    const form = document.getElementById("auth-form");
    const tabLogin = document.getElementById("tab-login");
    const tabSignup = document.getElementById("tab-signup");
    const submit = document.getElementById("submit");
    const msg = document.getElementById("msg");

    let mode = "login";

    function updateMode(next) {
      mode = next;
      submit.textContent = mode === "login" ? "로그인" : "회원가입";
      msg.textContent = "";
    }

    tabLogin.onclick = () => updateMode("login");
    tabSignup.onclick = () => updateMode("signup");

    form.onsubmit = async (e) => {
      e.preventDefault();
      const username = document.getElementById("username").value.trim();
      const password = document.getElementById("password").value;

      submit.disabled = true;
      try {
        if (mode === "login") await signInWithUsername(username, password);
        else await signUpWithUsername(username, password);
        msg.textContent = "성공. 이동 중...";
      } catch (err) {
        msg.textContent = err.message;
      } finally {
        submit.disabled = false;
      }
    };
  </script>
</body>
</html>
